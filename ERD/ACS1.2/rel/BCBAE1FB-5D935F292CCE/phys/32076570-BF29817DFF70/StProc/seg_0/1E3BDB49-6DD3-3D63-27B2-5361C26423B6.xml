<?xml version = '1.0' encoding = 'UTF-8'?>
<StoredProcedureOraclev10g class="oracle.dbtools.crest.model.design.storage.oracle.v10g.StoredProcedureOraclev10g" name="RECOVER_PS" directorySegmentName="seg_0" id="1E3BDB49-6DD3-3D63-27B2-5361C26423B6">
<sourceConnName>osd11g</sourceConnName>
<sourceObjSchema>OSD</sourceObjSchema>
<sourceObjName>RECOVER_PS</sourceObjName>
<createdBy>Administrator</createdBy>
<createdTime>2014-12-02 09:16:58 UTC</createdTime>
<ownerDesignName>ACS1.1</ownerDesignName>
<owner>C5730B64-FB4D-9F2E-CCB9-0672373953FB</owner>
<source>CREATE OR REPLACE PROCEDURE     OSD.RECOVER_PS&lt;br/&gt;IS&lt;br/&gt;   CURSOR ar&lt;br/&gt;   IS&lt;br/&gt;      SELECT   process_no, YEAR, current_dept, in_date, action_code,&lt;br/&gt;               sent_user, rec_user, log_count&lt;br/&gt;          FROM osd.process_status&lt;br/&gt;         WHERE YEAR &gt;= 33&lt;br/&gt;           AND sader_no IS NULL&lt;br/&gt;           AND action_code NOT IN (101, 102, 103, 104)&lt;br/&gt;      ORDER BY process_no;&lt;br/&gt;&lt;br/&gt;   v_count_s      NUMBER;&lt;br/&gt;   v_count_s1     NUMBER;&lt;br/&gt;   v_count_l      NUMBER;&lt;br/&gt;   v_count_l1     NUMBER;&lt;br/&gt;   v_rec          NUMBER;&lt;br/&gt;   v_serial       NUMBER;&lt;br/&gt;   v_from_dept    VARCHAR2 (10);&lt;br/&gt;   v_to_dept      VARCHAR2 (10);&lt;br/&gt;   v_cdept        VARCHAR2 (10);&lt;br/&gt;   v_sent_user    NUMBER;&lt;br/&gt;   v_rec_user     NUMBER;&lt;br/&gt;   v_rec_date     VARCHAR2 (10);&lt;br/&gt;   v_action       NUMBER;&lt;br/&gt;   v_in_date      VARCHAR2 (10);&lt;br/&gt;   v_department   NUMBER;&lt;br/&gt;   v_dept         NUMBER;&lt;br/&gt;   v_log_count    NUMBER;&lt;br/&gt;   v_sader        NUMBER;&lt;br/&gt;   v_date         VARCHAR2 (10);&lt;br/&gt;   v_count        NUMBER;&lt;br/&gt;BEGIN&lt;br/&gt;   FOR i IN ar&lt;br/&gt;   LOOP&lt;br/&gt;      BEGIN&lt;br/&gt;         SELECT COUNT (*)&lt;br/&gt;           INTO v_count_s&lt;br/&gt;           FROM osd.comm_sader&lt;br/&gt;          WHERE process_no = i.process_no AND YEAR = i.YEAR AND linked = 0;&lt;br/&gt;&lt;br/&gt;         SELECT COUNT (*)&lt;br/&gt;           INTO v_count_s1&lt;br/&gt;           FROM osd.comm_sader1&lt;br/&gt;          WHERE process_no = i.process_no AND YEAR = i.YEAR AND linked = 0;&lt;br/&gt;&lt;br/&gt;         SELECT COUNT (*)&lt;br/&gt;           INTO v_count_l&lt;br/&gt;           FROM osd.comm_sader&lt;br/&gt;          WHERE process_no = i.process_no AND YEAR = i.YEAR AND linked = 1;&lt;br/&gt;&lt;br/&gt;         SELECT COUNT (*)&lt;br/&gt;           INTO v_count_s1&lt;br/&gt;           FROM osd.comm_sader1&lt;br/&gt;          WHERE process_no = i.process_no AND YEAR = i.YEAR AND linked = 1;&lt;br/&gt;&lt;br/&gt;--------------------------------------------------------------------------------------------------------------&lt;br/&gt;         IF v_count_s &gt; 0&lt;br/&gt;         THEN                                                  -- ...... .....&lt;br/&gt;            SELECT NVL (sader_no, 0),&lt;br/&gt;                      NVL (sader_date_yy, 0)&lt;br/&gt;                   || &apos;/&apos;&lt;br/&gt;                   || LPAD (TO_CHAR (NVL (sader_date_mm, 0)), 2, &apos;0&apos;)&lt;br/&gt;                   || &apos;/&apos;&lt;br/&gt;                   || LPAD (TO_CHAR (NVL (sader_date_dd, 0)), 2, &apos;0&apos;),&lt;br/&gt;                   user_id&lt;br/&gt;              INTO v_sader,&lt;br/&gt;                   v_date,&lt;br/&gt;                   v_sent_user&lt;br/&gt;              FROM osd.comm_sader&lt;br/&gt;             WHERE process_no = i.process_no AND YEAR = i.YEAR;&lt;br/&gt;&lt;br/&gt;--------------------------------&lt;br/&gt;            UPDATE osd.process_status&lt;br/&gt;               SET action_code = 101,&lt;br/&gt;                   sader_no = v_sader,&lt;br/&gt;                   in_date = v_date,&lt;br/&gt;                   sent_user = v_sent_user&lt;br/&gt;             WHERE process_no = i.process_no;&lt;br/&gt;&lt;br/&gt;            COMMIT;&lt;br/&gt;-------------------------------------------------------------------------------------------------------------&lt;br/&gt;         ELSIF v_count_s1 &gt; 0&lt;br/&gt;         THEN                                                  -- ...... .....&lt;br/&gt;            SELECT NVL (sader_no, 0),&lt;br/&gt;                      NVL (sader_date_yy, 0)&lt;br/&gt;                   || &apos;/&apos;&lt;br/&gt;                   || LPAD (TO_CHAR (NVL (sader_date_mm, 0)), 2, &apos;0&apos;)&lt;br/&gt;                   || &apos;/&apos;&lt;br/&gt;                   || LPAD (TO_CHAR (NVL (sader_date_dd, 0)), 2, &apos;0&apos;),&lt;br/&gt;                   user_id&lt;br/&gt;              INTO v_sader,&lt;br/&gt;                   v_date,&lt;br/&gt;                   v_sent_user&lt;br/&gt;              FROM osd.comm_sader1&lt;br/&gt;             WHERE process_no = i.process_no AND YEAR = i.YEAR;&lt;br/&gt;&lt;br/&gt;--------------------------------&lt;br/&gt;            UPDATE osd.process_status&lt;br/&gt;               SET action_code = 103,&lt;br/&gt;                   sader_no = v_sader,&lt;br/&gt;                   in_date = v_date,&lt;br/&gt;                   sent_user = v_sent_user&lt;br/&gt;             WHERE process_no = i.process_no;&lt;br/&gt;&lt;br/&gt;            COMMIT;&lt;br/&gt;--------------------------------------------------------------------------------------------------------&lt;br/&gt;         ELSIF v_count_l &gt; 0&lt;br/&gt;         THEN                                         -- ....... ....... .....&lt;br/&gt;            SELECT NVL (sader_no, 0),&lt;br/&gt;                      NVL (sader_date_yy, 0)&lt;br/&gt;                   || &apos;/&apos;&lt;br/&gt;                   || LPAD (TO_CHAR (NVL (sader_date_mm, 0)), 2, &apos;0&apos;)&lt;br/&gt;                   || &apos;/&apos;&lt;br/&gt;                   || LPAD (TO_CHAR (NVL (sader_date_dd, 0)), 2, &apos;0&apos;),&lt;br/&gt;                   user_id&lt;br/&gt;              INTO v_sader,&lt;br/&gt;                   v_date,&lt;br/&gt;                   v_sent_user&lt;br/&gt;              FROM osd.comm_sader&lt;br/&gt;             WHERE process_no = i.process_no AND YEAR = i.YEAR;&lt;br/&gt;&lt;br/&gt;--------------------------------&lt;br/&gt;            UPDATE osd.process_status&lt;br/&gt;               SET action_code = 103,&lt;br/&gt;                   sader_no = v_sader,&lt;br/&gt;                   in_date = v_date,&lt;br/&gt;                   sent_user = v_sent_user&lt;br/&gt;             WHERE process_no = i.process_no;&lt;br/&gt;&lt;br/&gt;            COMMIT;&lt;br/&gt;         ELSIF v_count_l1 &gt; 0&lt;br/&gt;         THEN                                          --....... ....... .....&lt;br/&gt;            SELECT NVL (sader_no, 0),&lt;br/&gt;                      NVL (sader_date_yy, 0)&lt;br/&gt;                   || &apos;/&apos;&lt;br/&gt;                   || LPAD (TO_CHAR (NVL (sader_date_mm, 0)), 2, &apos;0&apos;)&lt;br/&gt;                   || &apos;/&apos;&lt;br/&gt;                   || LPAD (TO_CHAR (NVL (sader_date_dd, 0)), 2, &apos;0&apos;),&lt;br/&gt;                   user_id&lt;br/&gt;              INTO v_sader,&lt;br/&gt;                   v_date,&lt;br/&gt;                   v_sent_user&lt;br/&gt;              FROM osd.comm_sader1&lt;br/&gt;             WHERE process_no = i.process_no AND YEAR = i.YEAR;&lt;br/&gt;&lt;br/&gt;--------------------------------&lt;br/&gt;            UPDATE osd.process_status&lt;br/&gt;               SET action_code = 103,&lt;br/&gt;                   sader_no = v_sader,&lt;br/&gt;                   in_date = v_date,&lt;br/&gt;                   sent_user = v_sent_user&lt;br/&gt;             WHERE process_no = i.process_no;&lt;br/&gt;&lt;br/&gt;            COMMIT;&lt;br/&gt;-----------------------------------------------------------------------------------------------------------&lt;br/&gt;         ELSE&lt;br/&gt; ---------------------------------- not sader --------------------------------&lt;br/&gt;            SELECT MAX (serial_no)&lt;br/&gt;              INTO v_serial&lt;br/&gt;              FROM osd.auto_recieved&lt;br/&gt;             WHERE process_no = i.process_no;&lt;br/&gt;&lt;br/&gt;            BEGIN&lt;br/&gt;               SELECT action_code,&lt;br/&gt;                         in_date_yy&lt;br/&gt;                      || &apos;/&apos;&lt;br/&gt;                      || LPAD (TO_CHAR (in_date_mm), 2, &apos;0&apos;)&lt;br/&gt;                      || &apos;/&apos;&lt;br/&gt;                      || LPAD (TO_CHAR (in_date_dd), 2, &apos;0&apos;),&lt;br/&gt;                      department_no, dept_code, serial_no&lt;br/&gt;                 INTO v_action,&lt;br/&gt;                      v_in_date,&lt;br/&gt;                      v_department, v_dept, v_log_count&lt;br/&gt;                 FROM osd.comm_all&lt;br/&gt;                WHERE process_no = i.process_no AND serial_no = v_serial;&lt;br/&gt;            EXCEPTION&lt;br/&gt;               WHEN NO_DATA_FOUND&lt;br/&gt;               THEN&lt;br/&gt;                  NULL;&lt;br/&gt;            END;&lt;br/&gt;&lt;br/&gt;---------------------------------------&lt;br/&gt;            BEGIN&lt;br/&gt;               SELECT rec_flag, rec_date, sent_user, rec_user,&lt;br/&gt;                      from_dept, to_dept&lt;br/&gt;                 INTO v_rec, v_rec_date, v_sent_user, v_rec_user,&lt;br/&gt;                      v_from_dept, v_to_dept&lt;br/&gt;                 FROM osd.auto_recieved&lt;br/&gt;                WHERE process_no = i.process_no AND serial_no = v_serial;&lt;br/&gt;            EXCEPTION&lt;br/&gt;               WHEN NO_DATA_FOUND&lt;br/&gt;               THEN&lt;br/&gt;                  NULL;&lt;br/&gt;            END;&lt;br/&gt;&lt;br/&gt;            IF v_rec = 0&lt;br/&gt;            THEN&lt;br/&gt;               v_cdept := v_from_dept;&lt;br/&gt;               v_sent_user := v_sent_user;&lt;br/&gt;               v_rec_user := NULL;&lt;br/&gt;            ELSIF v_rec = 1&lt;br/&gt;            THEN&lt;br/&gt;               v_cdept := v_to_dept;&lt;br/&gt;               v_sent_user := v_sent_user;&lt;br/&gt;               v_rec_user := v_rec_user;&lt;br/&gt;            END IF;&lt;br/&gt;&lt;br/&gt;---------------------------------------&lt;br/&gt;            UPDATE osd.process_status&lt;br/&gt;               SET action_code = v_action,&lt;br/&gt;                   in_date = v_in_date,&lt;br/&gt;                   department_no = v_department,&lt;br/&gt;                   dept_code = v_dept,&lt;br/&gt;                   log_count = v_log_count,&lt;br/&gt;                   current_dept = v_cdept,&lt;br/&gt;                   sent_user = v_sent_user,&lt;br/&gt;                   rec_user = v_rec_user,&lt;br/&gt;                   rec_date = v_rec_date&lt;br/&gt;             WHERE process_no = i.process_no;&lt;br/&gt;&lt;br/&gt;            COMMIT;&lt;br/&gt;         END IF;&lt;br/&gt;      EXCEPTION&lt;br/&gt;         WHEN NO_DATA_FOUND&lt;br/&gt;         THEN&lt;br/&gt;            NULL;&lt;br/&gt;      END;&lt;br/&gt;   END LOOP;&lt;br/&gt;EXCEPTION&lt;br/&gt;   WHEN NO_DATA_FOUND&lt;br/&gt;   THEN&lt;br/&gt;      NULL;&lt;br/&gt;END;</source>
<body>CREATE OR REPLACE PROCEDURE     OSD.RECOVER_PS&lt;br/&gt;IS&lt;br/&gt;   CURSOR ar&lt;br/&gt;   IS&lt;br/&gt;      SELECT   process_no, YEAR, current_dept, in_date, action_code,&lt;br/&gt;               sent_user, rec_user, log_count&lt;br/&gt;          FROM osd.process_status&lt;br/&gt;         WHERE YEAR &gt;= 33&lt;br/&gt;           AND sader_no IS NULL&lt;br/&gt;           AND action_code NOT IN (101, 102, 103, 104)&lt;br/&gt;      ORDER BY process_no;&lt;br/&gt;&lt;br/&gt;   v_count_s      NUMBER;&lt;br/&gt;   v_count_s1     NUMBER;&lt;br/&gt;   v_count_l      NUMBER;&lt;br/&gt;   v_count_l1     NUMBER;&lt;br/&gt;   v_rec          NUMBER;&lt;br/&gt;   v_serial       NUMBER;&lt;br/&gt;   v_from_dept    VARCHAR2 (10);&lt;br/&gt;   v_to_dept      VARCHAR2 (10);&lt;br/&gt;   v_cdept        VARCHAR2 (10);&lt;br/&gt;   v_sent_user    NUMBER;&lt;br/&gt;   v_rec_user     NUMBER;&lt;br/&gt;   v_rec_date     VARCHAR2 (10);&lt;br/&gt;   v_action       NUMBER;&lt;br/&gt;   v_in_date      VARCHAR2 (10);&lt;br/&gt;   v_department   NUMBER;&lt;br/&gt;   v_dept         NUMBER;&lt;br/&gt;   v_log_count    NUMBER;&lt;br/&gt;   v_sader        NUMBER;&lt;br/&gt;   v_date         VARCHAR2 (10);&lt;br/&gt;   v_count        NUMBER;&lt;br/&gt;BEGIN&lt;br/&gt;   FOR i IN ar&lt;br/&gt;   LOOP&lt;br/&gt;      BEGIN&lt;br/&gt;         SELECT COUNT (*)&lt;br/&gt;           INTO v_count_s&lt;br/&gt;           FROM osd.comm_sader&lt;br/&gt;          WHERE process_no = i.process_no AND YEAR = i.YEAR AND linked = 0;&lt;br/&gt;&lt;br/&gt;         SELECT COUNT (*)&lt;br/&gt;           INTO v_count_s1&lt;br/&gt;           FROM osd.comm_sader1&lt;br/&gt;          WHERE process_no = i.process_no AND YEAR = i.YEAR AND linked = 0;&lt;br/&gt;&lt;br/&gt;         SELECT COUNT (*)&lt;br/&gt;           INTO v_count_l&lt;br/&gt;           FROM osd.comm_sader&lt;br/&gt;          WHERE process_no = i.process_no AND YEAR = i.YEAR AND linked = 1;&lt;br/&gt;&lt;br/&gt;         SELECT COUNT (*)&lt;br/&gt;           INTO v_count_s1&lt;br/&gt;           FROM osd.comm_sader1&lt;br/&gt;          WHERE process_no = i.process_no AND YEAR = i.YEAR AND linked = 1;&lt;br/&gt;&lt;br/&gt;--------------------------------------------------------------------------------------------------------------&lt;br/&gt;         IF v_count_s &gt; 0&lt;br/&gt;         THEN                                                  -- ...... .....&lt;br/&gt;            SELECT NVL (sader_no, 0),&lt;br/&gt;                      NVL (sader_date_yy, 0)&lt;br/&gt;                   || &apos;/&apos;&lt;br/&gt;                   || LPAD (TO_CHAR (NVL (sader_date_mm, 0)), 2, &apos;0&apos;)&lt;br/&gt;                   || &apos;/&apos;&lt;br/&gt;                   || LPAD (TO_CHAR (NVL (sader_date_dd, 0)), 2, &apos;0&apos;),&lt;br/&gt;                   user_id&lt;br/&gt;              INTO v_sader,&lt;br/&gt;                   v_date,&lt;br/&gt;                   v_sent_user&lt;br/&gt;              FROM osd.comm_sader&lt;br/&gt;             WHERE process_no = i.process_no AND YEAR = i.YEAR;&lt;br/&gt;&lt;br/&gt;--------------------------------&lt;br/&gt;            UPDATE osd.process_status&lt;br/&gt;               SET action_code = 101,&lt;br/&gt;                   sader_no = v_sader,&lt;br/&gt;                   in_date = v_date,&lt;br/&gt;                   sent_user = v_sent_user&lt;br/&gt;             WHERE process_no = i.process_no;&lt;br/&gt;&lt;br/&gt;            COMMIT;&lt;br/&gt;-------------------------------------------------------------------------------------------------------------&lt;br/&gt;         ELSIF v_count_s1 &gt; 0&lt;br/&gt;         THEN                                                  -- ...... .....&lt;br/&gt;            SELECT NVL (sader_no, 0),&lt;br/&gt;                      NVL (sader_date_yy, 0)&lt;br/&gt;                   || &apos;/&apos;&lt;br/&gt;                   || LPAD (TO_CHAR (NVL (sader_date_mm, 0)), 2, &apos;0&apos;)&lt;br/&gt;                   || &apos;/&apos;&lt;br/&gt;                   || LPAD (TO_CHAR (NVL (sader_date_dd, 0)), 2, &apos;0&apos;),&lt;br/&gt;                   user_id&lt;br/&gt;              INTO v_sader,&lt;br/&gt;                   v_date,&lt;br/&gt;                   v_sent_user&lt;br/&gt;              FROM osd.comm_sader1&lt;br/&gt;             WHERE process_no = i.process_no AND YEAR = i.YEAR;&lt;br/&gt;&lt;br/&gt;--------------------------------&lt;br/&gt;            UPDATE osd.process_status&lt;br/&gt;               SET action_code = 103,&lt;br/&gt;                   sader_no = v_sader,&lt;br/&gt;                   in_date = v_date,&lt;br/&gt;                   sent_user = v_sent_user&lt;br/&gt;             WHERE process_no = i.process_no;&lt;br/&gt;&lt;br/&gt;            COMMIT;&lt;br/&gt;--------------------------------------------------------------------------------------------------------&lt;br/&gt;         ELSIF v_count_l &gt; 0&lt;br/&gt;         THEN                                         -- ....... ....... .....&lt;br/&gt;            SELECT NVL (sader_no, 0),&lt;br/&gt;                      NVL (sader_date_yy, 0)&lt;br/&gt;                   || &apos;/&apos;&lt;br/&gt;                   || LPAD (TO_CHAR (NVL (sader_date_mm, 0)), 2, &apos;0&apos;)&lt;br/&gt;                   || &apos;/&apos;&lt;br/&gt;                   || LPAD (TO_CHAR (NVL (sader_date_dd, 0)), 2, &apos;0&apos;),&lt;br/&gt;                   user_id&lt;br/&gt;              INTO v_sader,&lt;br/&gt;                   v_date,&lt;br/&gt;                   v_sent_user&lt;br/&gt;              FROM osd.comm_sader&lt;br/&gt;             WHERE process_no = i.process_no AND YEAR = i.YEAR;&lt;br/&gt;&lt;br/&gt;--------------------------------&lt;br/&gt;            UPDATE osd.process_status&lt;br/&gt;               SET action_code = 103,&lt;br/&gt;                   sader_no = v_sader,&lt;br/&gt;                   in_date = v_date,&lt;br/&gt;                   sent_user = v_sent_user&lt;br/&gt;             WHERE process_no = i.process_no;&lt;br/&gt;&lt;br/&gt;            COMMIT;&lt;br/&gt;         ELSIF v_count_l1 &gt; 0&lt;br/&gt;         THEN                                          --....... ....... .....&lt;br/&gt;            SELECT NVL (sader_no, 0),&lt;br/&gt;                      NVL (sader_date_yy, 0)&lt;br/&gt;                   || &apos;/&apos;&lt;br/&gt;                   || LPAD (TO_CHAR (NVL (sader_date_mm, 0)), 2, &apos;0&apos;)&lt;br/&gt;                   || &apos;/&apos;&lt;br/&gt;                   || LPAD (TO_CHAR (NVL (sader_date_dd, 0)), 2, &apos;0&apos;),&lt;br/&gt;                   user_id&lt;br/&gt;              INTO v_sader,&lt;br/&gt;                   v_date,&lt;br/&gt;                   v_sent_user&lt;br/&gt;              FROM osd.comm_sader1&lt;br/&gt;             WHERE process_no = i.process_no AND YEAR = i.YEAR;&lt;br/&gt;&lt;br/&gt;--------------------------------&lt;br/&gt;            UPDATE osd.process_status&lt;br/&gt;               SET action_code = 103,&lt;br/&gt;                   sader_no = v_sader,&lt;br/&gt;                   in_date = v_date,&lt;br/&gt;                   sent_user = v_sent_user&lt;br/&gt;             WHERE process_no = i.process_no;&lt;br/&gt;&lt;br/&gt;            COMMIT;&lt;br/&gt;-----------------------------------------------------------------------------------------------------------&lt;br/&gt;         ELSE&lt;br/&gt; ---------------------------------- not sader --------------------------------&lt;br/&gt;            SELECT MAX (serial_no)&lt;br/&gt;              INTO v_serial&lt;br/&gt;              FROM osd.auto_recieved&lt;br/&gt;             WHERE process_no = i.process_no;&lt;br/&gt;&lt;br/&gt;            BEGIN&lt;br/&gt;               SELECT action_code,&lt;br/&gt;                         in_date_yy&lt;br/&gt;                      || &apos;/&apos;&lt;br/&gt;                      || LPAD (TO_CHAR (in_date_mm), 2, &apos;0&apos;)&lt;br/&gt;                      || &apos;/&apos;&lt;br/&gt;                      || LPAD (TO_CHAR (in_date_dd), 2, &apos;0&apos;),&lt;br/&gt;                      department_no, dept_code, serial_no&lt;br/&gt;                 INTO v_action,&lt;br/&gt;                      v_in_date,&lt;br/&gt;                      v_department, v_dept, v_log_count&lt;br/&gt;                 FROM osd.comm_all&lt;br/&gt;                WHERE process_no = i.process_no AND serial_no = v_serial;&lt;br/&gt;            EXCEPTION&lt;br/&gt;               WHEN NO_DATA_FOUND&lt;br/&gt;               THEN&lt;br/&gt;                  NULL;&lt;br/&gt;            END;&lt;br/&gt;&lt;br/&gt;---------------------------------------&lt;br/&gt;            BEGIN&lt;br/&gt;               SELECT rec_flag, rec_date, sent_user, rec_user,&lt;br/&gt;                      from_dept, to_dept&lt;br/&gt;                 INTO v_rec, v_rec_date, v_sent_user, v_rec_user,&lt;br/&gt;                      v_from_dept, v_to_dept&lt;br/&gt;                 FROM osd.auto_recieved&lt;br/&gt;                WHERE process_no = i.process_no AND serial_no = v_serial;&lt;br/&gt;            EXCEPTION&lt;br/&gt;               WHEN NO_DATA_FOUND&lt;br/&gt;               THEN&lt;br/&gt;                  NULL;&lt;br/&gt;            END;&lt;br/&gt;&lt;br/&gt;            IF v_rec = 0&lt;br/&gt;            THEN&lt;br/&gt;               v_cdept := v_from_dept;&lt;br/&gt;               v_sent_user := v_sent_user;&lt;br/&gt;               v_rec_user := NULL;&lt;br/&gt;            ELSIF v_rec = 1&lt;br/&gt;            THEN&lt;br/&gt;               v_cdept := v_to_dept;&lt;br/&gt;               v_sent_user := v_sent_user;&lt;br/&gt;               v_rec_user := v_rec_user;&lt;br/&gt;            END IF;&lt;br/&gt;&lt;br/&gt;---------------------------------------&lt;br/&gt;            UPDATE osd.process_status&lt;br/&gt;               SET action_code = v_action,&lt;br/&gt;                   in_date = v_in_date,&lt;br/&gt;                   department_no = v_department,&lt;br/&gt;                   dept_code = v_dept,&lt;br/&gt;                   log_count = v_log_count,&lt;br/&gt;                   current_dept = v_cdept,&lt;br/&gt;                   sent_user = v_sent_user,&lt;br/&gt;                   rec_user = v_rec_user,&lt;br/&gt;                   rec_date = v_rec_date&lt;br/&gt;             WHERE process_no = i.process_no;&lt;br/&gt;&lt;br/&gt;            COMMIT;&lt;br/&gt;         END IF;&lt;br/&gt;      EXCEPTION&lt;br/&gt;         WHEN NO_DATA_FOUND&lt;br/&gt;         THEN&lt;br/&gt;            NULL;&lt;br/&gt;      END;&lt;br/&gt;   END LOOP;&lt;br/&gt;EXCEPTION&lt;br/&gt;   WHEN NO_DATA_FOUND&lt;br/&gt;   THEN&lt;br/&gt;      NULL;&lt;br/&gt;END;</body>
</StoredProcedureOraclev10g>