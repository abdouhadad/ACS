<?xml version = '1.0' encoding = 'UTF-8'?>
<TriggerOraclev10g class="oracle.dbtools.crest.model.design.storage.oracle.v10g.TriggerOraclev10g" name="CIRCULARE" directorySegmentName="seg_0" id="4DB485B4-8ADC-BD5B-D099-1ED926BDD8C7">
<sourceConnName>osd11g</sourceConnName>
<sourceObjSchema>OSD</sourceObjSchema>
<sourceObjName>CIRCULARE</sourceObjName>
<createdBy>Administrator</createdBy>
<createdTime>2014-12-02 09:16:55 UTC</createdTime>
<ownerDesignName>ACS1.1</ownerDesignName>
<actions>INSERT, UPDATE, DELETE</actions>
<body>DECLARE&lt;br/&gt;  v_count         NUMBER;&lt;br/&gt;  v_subject       varchar2(300); &lt;br/&gt;  v_date          varchar2(10);&lt;br/&gt;  v_sader_date    varchar2(10);&lt;br/&gt;  v_sader_sec     number;&lt;br/&gt;  v_count_old     number;&lt;br/&gt;BEGIN&lt;br/&gt;      &lt;br/&gt;    if inserting then&lt;br/&gt;        &lt;br/&gt;        select count(process_no)  into v_count&lt;br/&gt;        from p9.circular&lt;br/&gt;        where process_no = :new.process_no&lt;br/&gt;        and sader_to = :new.sader_to;&lt;br/&gt;    &lt;br/&gt;        if  v_count &lt; 1 then&lt;br/&gt;            &lt;br/&gt;           if :NEW.IN_OUT_CODE = 1 and :NEW.ORGINAL_FLAG = 2 then &lt;br/&gt;                &lt;br/&gt;                select subject into v_subject &lt;br/&gt;                from osd.comm_master &lt;br/&gt;                where process_no = :new.process_no;&lt;br/&gt;                &lt;br/&gt;                select to_char(sysdate, &apos;rrrr-mm-dd&apos;) into v_date &lt;br/&gt;                from dual;&lt;br/&gt;                &lt;br/&gt;                select SADER_DATE_YY||&apos;/&apos;||lpad(to_char(SADER_DATE_MM),2,&apos;0&apos;)||&apos;/&apos;||lpad(to_char(SADER_DATE_DD),2,&apos;0&apos;), sader_sec into v_sader_date, v_sader_sec&lt;br/&gt;                from osd.comm_sader &lt;br/&gt;                where process_no = :new.process_no;&lt;br/&gt;                &lt;br/&gt;                insert into p9.circular --(process_no,      date,  sader_no,     sader_date,     subject,   sader_to,     status, note , type          ) &lt;br/&gt;                                 values (:new.process_no, v_date, :new.sader_no, v_sader_date, v_subject,  :new.sader_to, 1,   &apos;???????&apos; ,  v_sader_sec ) ;   &lt;br/&gt;           end if;&lt;br/&gt;            &lt;br/&gt;        end if;&lt;br/&gt;    &lt;br/&gt;    elsif deleting then&lt;br/&gt;        &lt;br/&gt;        select count(process_no)  into v_count_old&lt;br/&gt;        from p9.circular&lt;br/&gt;        where process_no = :old.process_no&lt;br/&gt;        and sader_to = :old.sader_to;&lt;br/&gt;    &lt;br/&gt;        if v_count_old &gt; 0 then&lt;br/&gt;           &lt;br/&gt;           delete from p9.circular&lt;br/&gt;           where process_no = :old.process_no&lt;br/&gt;           and sader_to = :old.sader_to;&lt;br/&gt;        &lt;br/&gt;        end if;&lt;br/&gt;    &lt;br/&gt;    end if;&lt;br/&gt;    &lt;br/&gt;EXCEPTION&lt;br/&gt;   WHEN OTHERS THEN&lt;br/&gt;     -- Consider logging the error and then re-raise  &lt;br/&gt;     RAISE;&lt;br/&gt;END; </body>
<triggerTime>AFTER</triggerTime>
<owner>C5730B64-FB4D-9F2E-CCB9-0672373953FB</owner>
<table>9EF873FC-FFD0-10E9-9312-E920B9BA05DE</table>
</TriggerOraclev10g>