<?xml version = '1.0' encoding = 'UTF-8'?>
<FunctionOracle class="oracle.dbtools.crest.model.design.storage.oracle.FunctionOracle" name="GET_PROC_LAST_EMP_DEPT" directorySegmentName="seg_0" id="CC49B9BC-38E0-385D-49F9-09894E947452">
<sourceConnName>osd11g</sourceConnName>
<sourceObjSchema>OSD</sourceObjSchema>
<sourceObjName>GET_PROC_LAST_EMP_DEPT</sourceObjName>
<createdBy>Administrator</createdBy>
<createdTime>2014-12-02 09:16:58 UTC</createdTime>
<ownerDesignName>ACS1.1</ownerDesignName>
<owner>C5730B64-FB4D-9F2E-CCB9-0672373953FB</owner>
<source>CREATE OR REPLACE function     OSD.GET_PROC_LAST_EMP_DEPT(p_proc number, p_dept number) return varchar2 is&lt;br/&gt;    v_serial number;&lt;br/&gt;    v_emp    number;&lt;br/&gt;    v_ename  varchar2(300);&lt;br/&gt;    &lt;br/&gt;&lt;br/&gt;begin&lt;br/&gt;    &lt;br/&gt;    SELECT nvl(max(serial_no),0) into v_serial&lt;br/&gt;    FROM osd.employee_actions&lt;br/&gt;    WHERE process_no  = p_proc&lt;br/&gt;    and department_no = p_dept; &lt;br/&gt;    &lt;br/&gt;    if v_serial &gt; 0 then&lt;br/&gt;    &lt;br/&gt;        select employee_no into v_emp&lt;br/&gt;        from osd.employee_actions&lt;br/&gt;        where process_no = p_proc &lt;br/&gt;        and serial_no = v_serial&lt;br/&gt;        and department_no = p_dept;&lt;br/&gt;        &lt;br/&gt;        --and rownum = 1;       &lt;br/&gt;        &lt;br/&gt;        begin&lt;br/&gt;            select employee_first_name||&apos; &apos;||employee_father_name||&apos; &apos;||employee_grand_name||&apos; &apos;||employee_family_name into v_ename&lt;br/&gt;            from osd.comm_employees&lt;br/&gt;            where employee_no = v_emp&lt;br/&gt;            and department_no = p_dept;&lt;br/&gt;        exception&lt;br/&gt;            when no_data_found then&lt;br/&gt;               v_ename:= &apos;&apos;;            &lt;br/&gt;        end;&lt;br/&gt;    &lt;br/&gt;    else v_ename:= &apos;&apos;;&lt;br/&gt;        &lt;br/&gt;    end if;&lt;br/&gt;    &lt;br/&gt;    return v_ename;&lt;br/&gt;    &lt;br/&gt;end;</source>
</FunctionOracle>